# leakbin 

XS-Leak, CSRF, COOP

Didn't have time to finish the solve script but here's a small writeup:
 - For every character, create a paste with a lot of As in the title, and the part of the flag you're bruteforcing goes in the content.
 - Now try to search "ASIS{" + to_brute. If the search is right then you should find two pastes: One with the flag and the other with a lot of As. Their title and their id now goes in the session cookie, but you would be logged out since the cookies have a length limit. Then if you try to go to /home, you should be redirected to /login, and you can use this as an oracle
 - Abuse COOP and Max Redirect to detect if the bot has been logged out
    - You can check if w.closed is true
    - You can also try to redirect the bot to `about:blank `while it's still on the `ERR_TOO_MANY_REDIRECTS` page. If `w.history` is accessible it means that the bot has been logged out. If not, the search was unsuccessful.